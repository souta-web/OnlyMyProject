いろいろ修正内容書いたけどおそらく全体的に作り直しになるから、現在のプログラムに修正をすることはないかも
未修正：chat_histry_register.dart 54行目のfalseのところはデータベースの値を取得して引数を渡すようにしてください。
未修正：RegisterAction-_sendAction アクション送信時の登録内容はnotionの「actionをデータベースに登録する」のコメントに沿って作成してください。
未修正：インデントを整える。
未修正：空文字を送信したときに「データが登録されました」が表示され、「データが登録されました」自体がデータベースに登録される問題。（後々返信はAIからのみになるから後回しで〇）
未修正：action登録時にはchat_tableとaction_tableにそれぞれ必要なデータを登録しますが、吹き出しの表示自体はしないです。表示はChatTodoのみです。
未修正：データベースにデータを登録した段階で「データが登録されました」の表示とデータベースへの登録の必要はないです。(返信はAIからもらうため)
未修正：register_text.dart-handLeSubmittedでやりたいことがよくわからない。
未修正：database_helper.dartのchat_tableのカラムにメディア用のカラムがないから追加。(画像の仕様について詳しくわからないから最上君と相談します)


送信ボタンを押したときの処理はもっと簡潔に書けそうなのでそのための詳細書きました↓
送信ボタン押したときの処理ざっくりわけると
・データベース登録
・吹き出し、アクション表示
なので最終的な処理の流れとしては
1.chat_tableに登録(トグルボタンがオンオフどちらでも共通)
2.if(トグルボタンがオン)→action_tableに登録
3.if(トグルボタンのオフ、オン)→吹き出し、アクション表示

------解説-------
・データベース登録
→通常チャット時(chat_table)
 アクション時(chat_table,action_table)
 
chat_tableに登録するカラムは共通しているので、そこまでは一つの関数で処理して問題ない
登録カラム→(columnChatSender,columnChatTodo,columnChatTodofinish,columnChatMessage,columnChatTime)

その後はif文でトグルボタンの状態を受け取ってtrueならaction_tableへのデータ登録をする

吹き出しなどの画面表示についてもif文でトグルボタンの状態に応じて表示させる

なので必要な関数は大きく分けて↓の三つになる
registerChatTable(チャットテーブルへの登録を担う)
registerActionTable(アクションテーブルへの登録を担う)
drawChatObjects(トグルボタンの状態によってオブジェクト表示をする)

------実際に実装するとこんな感じ↓------
sendButtonPressed(引数){ //送信ボタンが押されたときに呼び出される
    registerChatTable(引数) //ここは確定で呼び出す
    if (_isTodo) { //トグルボタンがオンの時だけ呼び出す
        registerActionTable(引数)
    }
    return drawChatObjects(引数) //この関数内で吹き出しなどを作ってreturnで返す
}

------呼び出し元------
 onPressed: (){
    _messages.add(sendButtonPressed(引数))
 }

これ以外にもいろいろやり方はあると思うけど今の段階で思いつくのはこんな感じ

